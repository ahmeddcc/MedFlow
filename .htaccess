# إعادة كتابة الروابط
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /MedFlow/
    
    # إذا كان الملف أو المجلد موجود، استخدمه
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # توجيه جميع الطلبات إلى index.php
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>

# حماية المجلدات الحساسة
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# منع الوصول المباشر للمجلدات الحساسة
RewriteRule ^(app|database|bootstrap|includes|logs|vendor)/ - [F,L]
RewriteRule ^(composer\.json|composer\.lock|\.env|\.git) - [F,L]
<FilesMatch "\.(php|sql|log|env)$">
    # السماح فقط لـ index.php
    Order allow,deny
    Deny from all
</FilesMatch>
<Files "index.php">
    Order allow,deny
    Allow from all
</Files>

# ضبط ترميز UTF-8
AddDefaultCharset UTF-8

# تعطيل عرض قائمة الملفات
Options -Indexes

# حماية ملفات الإعدادات
<Files "*.sql">
    Order allow,deny
    Deny from all
</Files>

<Files "*.env">
    Order allow,deny
    Deny from all
</Files>

<Files "*.log">
    Order allow,deny
    Deny from all
</Files>

# ضغط الملفات
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# التخزين المؤقت
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType text/css "access plus 1 week"
    ExpiresByType application/javascript "access plus 1 week"
</IfModule>
